(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerPolicy&&(l.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?l.credentials="include":t.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(t){if(t.ep)return;t.ep=!0;const l=o(t);fetch(t.href,l)}})();Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwZmZlYmExOS05NTFkLTQxOTgtYmViMy0yMTg0MjY0YWI3N2EiLCJpZCI6Mzg3MTMwLCJpYXQiOjE3NzAyNDg0Nzd9.IqoW2git6t3j4YITrlQTN_U95ox-h-mfrMfON2aGyLw";const te="AIzaSyB5Tu2LL6QodOX-UOai4L_MsZn6GBvj5ec";console.log("GOOGLE KEY (first 6):",te.slice(0,6));const d=document.createElement("div");d.textContent="Loading 3D…";d.style.position="absolute";d.style.top="50%";d.style.left="50%";d.style.transform="translate(-50%, -50%)";d.style.backgroundColor="rgba(0, 0, 0, 0.8)";d.style.color="white";d.style.padding="20px 40px";d.style.borderRadius="5px";d.style.fontFamily="sans-serif";d.style.fontSize="18px";d.style.zIndex="10000";document.body.appendChild(d);const s=new Cesium.Viewer("cesiumContainer",{terrain:Cesium.Terrain.fromWorldTerrain(),animation:!1,timeline:!1,baseLayerPicker:!1,geocoder:!1,homeButton:!1,sceneModePicker:!1,navigationHelpButton:!1,requestRenderMode:!0,maximumRenderTimeChange:1/0});s.camera.setView({destination:Cesium.Cartesian3.fromDegrees(-97.7581450173393,30.263674724875994,273.7391351131449),orientation:{heading:Cesium.Math.toRadians(69.47537836441508),pitch:Cesium.Math.toRadians(-8.108186336933453),roll:0}});s.camera.frustum.fov=Cesium.Math.toRadians(110);const T=s.scene.screenSpaceCameraController;T.enableRotate=!1;T.enableTilt=!1;T.enableZoom=!1;T.enableLook=!0;T.enableTranslate=!1;T.lookEventTypes=[Cesium.CameraEventType.LEFT_DRAG];T.rotateEventTypes=[];T.tiltEventTypes=[];s.scene.preUpdate.addEventListener(()=>{Math.abs(s.camera.roll)>Cesium.Math.EPSILON6&&s.camera.setView({orientation:{heading:s.camera.heading,pitch:s.camera.pitch,roll:0}})});const ne=`https://tile.googleapis.com/v1/3dtiles/root.json?key=${te}`;console.log("Tiles URL:",ne);const oe=await Cesium.Cesium3DTileset.fromUrl(ne,{maximumScreenSpaceError:24,skipLevelOfDetail:!0,baseScreenSpaceError:1024,skipScreenSpaceErrorFactor:16,skipLevels:1,immediatelyLoadDesiredLevelOfDetail:!1,maximumMemoryUsage:512,cullWithChildrenBounds:!0});s.scene.primitives.add(oe);const I=[{name:"3Waller",lat:30.2636556,lon:-97.7363348,type:"condo"},{name:"404 Rio Grande",lat:30.2687242,lon:-97.7501364,type:"condo"},{name:"Alexan Waterloo",lat:30.2710308,lon:-97.7338734,type:"apartment"},{name:"AMLI Downtown",lat:30.265293,lon:-97.746328,type:"apartment"},{name:"AMLI on 2nd",lat:30.2662019,lon:-97.7480112,type:"apartment"},{name:"Ashton Austin",lat:30.2641297,lon:-97.7453625,type:"apartment"},{name:"Camden Rainey Street",lat:30.2603388,lon:-97.738071,type:"apartment"},{name:"Capitol Quarters",lat:30.2750244,lon:-97.7466199,type:"apartment"},{name:"Elle West Ave",lat:30.268646,lon:-97.7530446,type:"apartment"},{name:"Gables Park Plaza",lat:30.2682716,lon:-97.7548273,type:"apartment"},{name:"Gables Park Tower",lat:30.2667539,lon:-97.7547424,type:"apartment"},{name:"Gables Republic Square",lat:30.2673738,lon:-97.7467997,type:"apartment"},{name:"Hanover Brazos St",lat:30.2645712,lon:-97.7424911,type:"apartment"},{name:"Hanover Republic",lat:30.267788,lon:-97.7459658,type:"apartment"},{name:"Lantana",lat:30.2823515,lon:-97.746431,type:"apartment"},{name:"Northshore",lat:30.2653566,lon:-97.7491832,type:"apartment"},{name:"Penthouse",lat:30.2817358,lon:-97.7448273,type:"condo"},{name:"Residences at 6G",lat:30.2696502,lon:-97.7466781,type:"condo"},{name:"Seven",lat:30.2705777,lon:-97.7488733,type:"apartment"},{name:"Sienna at the Thompson",lat:30.2669225,lon:-97.7416013,type:"apartment"},{name:"Skyhouse Austin",lat:30.257024,lon:-97.7390392,type:"apartment"},{name:"The Beverly at Medical Center",lat:30.2696224,lon:-97.735692,type:"apartment"},{name:"The Bowie",lat:30.2689101,lon:-97.7533905,type:"apartment"},{name:"The G",lat:30.2802583,lon:-97.7418612,type:"condo"},{name:"The Monarch by Windsor",lat:30.2690858,lon:-97.7520471,type:"apartment"},{name:"The Quincy",lat:30.2607964,lon:-97.7388694,type:"condo"},{name:"The Shoal",lat:30.2760586,lon:-97.7496873,type:"apartment"},{name:"The Waller",lat:30.2711278,lon:-97.7344463,type:"condo"},{name:"Whitley",lat:30.2650437,lon:-97.742201,type:"apartment"},{name:"Windsor on the Lake",lat:30.2559717,lon:-97.7396004,type:"apartment"},{name:"ATX Tower",lat:30.268662,lon:-97.7460608,type:"condo"},{name:"415 Colorado",lat:30.2672311,lon:-97.7442783,type:"condo"},{name:"Waterline",lat:30.2615462,lon:-97.7391219,type:"condo"},{name:"The Travis",lat:30.260094,lon:-97.7401425,type:"condo"},{name:"Paseo",lat:30.260094,lon:-97.7401425,type:"condo"},{name:"700 River",lat:30.2579816,lon:-97.7387225,type:"condo"},{name:"Austin Proper",lat:30.2662394,lon:-97.7499189,type:"condo"},{name:"Vesper",lat:30.2597364,lon:-97.7375573,type:"condo"},{name:"Plaza Lofts",lat:30.2679234,lon:-97.7464443,type:"condo"},{name:"1704 West Condos",lat:30.2815211,lon:-97.746815,type:"condo"},{name:"Four Seasons",lat:30.2619861,lon:-97.7432297,type:"condo"},{name:"The Modern",lat:30.2604192,lon:-97.7392711,type:"condo"},{name:"The Austonian",lat:30.2648019,lon:-97.7445985,type:"condo"},{name:"W Residences",lat:30.2655902,lon:-97.7465586,type:"condo"},{name:"The Linden",lat:30.2794998,lon:-97.7420515,type:"condo"},{name:"The Independent",lat:30.2677663,lon:-97.7512619,type:"condo"},{name:"70 Rainey",lat:30.2586803,lon:-97.7391402,type:"condo"},{name:"Natiivo",lat:30.2564815,lon:-97.7388538,type:"condo"},{name:"Seaholm Residences",lat:30.2671786,lon:-97.7521108,type:"condo"},{name:"44 East",lat:30.2558158,lon:-97.7390961,type:"condo"},{name:"5th & West",lat:30.2698622,lon:-97.7505104,type:"condo"},{name:"Nokonah",lat:30.2735314,lon:-97.7527068,type:"apartment"},{name:"360 Condos",lat:30.2672801,lon:-97.7497187,type:"condo"},{name:"Spring Condos",lat:30.2689443,lon:-97.7541734,type:"condo"},{name:"1306 West",lat:30.2779487,lon:-97.7481718,type:"condo"},{name:"Westgate Tower",lat:30.2741074,lon:-97.7428798,type:"condo"},{name:"904 West Condos",lat:30.2736945,lon:-97.7497312,type:"condo"},{name:"The Shore",lat:30.2593466,lon:-97.7393206,type:"condo"},{name:"Five Fifty 05",lat:30.265231,lon:-97.7381056,type:"condo"},{name:"Penthouse Condos",lat:30.275913,lon:-97.7441529,type:"condo"},{name:"Austin City Lofts",lat:30.2697168,lon:-97.7516014,type:"condo"},{name:"Brown Building",lat:30.2700066,lon:-97.7438733,type:"condo"},{name:"Cambridge Tower",lat:30.2807704,lon:-97.7403971,type:"condo"},{name:"Celias Court",lat:30.2731851,lon:-97.7473822,type:"condo"},{name:"Milago",lat:30.2569365,lon:-97.7397606,type:"condo"},{name:"Sabine on 5th",lat:30.2654934,lon:-97.7361143,type:"condo"},{name:"Brazos Place",lat:30.2698301,lon:-97.7408344,type:"condo"},{name:"Terrace on Shoal Creek",lat:30.2756567,lon:-97.7503839,type:"apartment"},{name:"Towers of Town Lake",lat:30.2550288,lon:-97.7379358,type:"condo"},{name:"Greenwood Tower",lat:30.2805409,lon:-97.7411384,type:"condo"}];let C=null,v=10,w=0,E=15,X=!0,j=!1;const Y=new Map;async function D(e,n,o,a=3.1,t,l=-10,c=15){const R=`${e},${n}`;if(!Y.has(R)){const ye=Cesium.Cartographic.fromDegrees(n,e),[ue]=await Cesium.sampleTerrainMostDetailed(s.terrainProvider,[ye]);Y.set(R,ue.height)}const le=Y.get(R)+o*a,se=Cesium.Cartesian3.fromDegrees(n,e,le),K=Cesium.Math.toRadians(t),ie=c*Math.sin(K),re=c*Math.cos(K),de=0,ce=Cesium.Transforms.eastNorthUpToFixedFrame(se),pe=new Cesium.Cartesian3(ie,re,de),me=Cesium.Matrix4.multiplyByPoint(ce,pe,new Cesium.Cartesian3);s.camera.setView({destination:me,orientation:{heading:Cesium.Math.toRadians(t),pitch:Cesium.Math.toRadians(l),roll:0}}),s.camera.frustum.fov=Cesium.Math.toRadians(100),s.scene.requestRender()}const r=document.createElement("div");r.style.position="absolute";r.style.top="10px";r.style.left="10px";r.style.backgroundColor="rgba(0, 0, 0, 0.7)";r.style.color="white";r.style.padding="15px";r.style.borderRadius="5px";r.style.fontFamily="sans-serif";r.style.fontSize="14px";r.style.zIndex="1000";const i=document.createElement("button");i.textContent="◀";i.style.position="absolute";i.style.top="5px";i.style.right="5px";i.style.width="25px";i.style.height="25px";i.style.padding="0";i.style.backgroundColor="#555";i.style.color="white";i.style.border="1px solid #666";i.style.borderRadius="3px";i.style.cursor="pointer";i.style.fontSize="12px";i.title="Collapse panel";r.appendChild(i);const m=document.createElement("div");let J=!1;i.onclick=()=>{J=!J,J?(m.style.display="none",r.style.padding="5px",r.style.width="35px",i.textContent="▶",i.title="Expand panel"):(m.style.display="block",r.style.padding="15px",r.style.width="auto",i.textContent="◀",i.title="Collapse panel")};const O=document.createElement("div");O.textContent="Building:";O.style.marginBottom="8px";O.style.fontWeight="bold";m.appendChild(O);const p=document.createElement("select");p.style.width="100%";p.style.padding="5px";p.style.marginBottom="15px";p.style.backgroundColor="#333";p.style.color="white";p.style.border="1px solid #555";p.style.borderRadius="3px";p.style.fontSize="14px";function Z(){p.innerHTML="";const e=document.createElement("option");e.value="",e.textContent="Select a building",e.disabled=!0,e.selected=C===null,p.appendChild(e),I.map((o,a)=>({building:o,index:a})).filter(({building:o})=>o.type==="condo"&&X||o.type==="apartment"&&j).sort((o,a)=>o.building.name.localeCompare(a.building.name)).forEach(({building:o,index:a})=>{const t=document.createElement("option");t.value=a,t.textContent=o.name,C===a&&(t.selected=!0),p.appendChild(t)})}p.onchange=()=>{if(p.value==="")return;C=parseInt(p.value);const e=I[C];D(e.lat,e.lon,v,3.1,w,-10,E)};Z();m.appendChild(p);const G=document.createElement("div");G.textContent="Floor:";G.style.marginBottom="8px";G.style.fontWeight="bold";m.appendChild(G);const U=document.createElement("div");U.style.marginBottom="15px";const he=[5,10,15,20,25,30,35,40];he.forEach(e=>{const n=document.createElement("button");n.textContent=e,n.style.margin="2px",n.style.padding="5px 10px",n.style.backgroundColor=e===v?"#4CAF50":"#555",n.style.color="white",n.style.border="none",n.style.borderRadius="3px",n.style.cursor="pointer",n.onclick=()=>{if(v=e,fe(),C!==null){const o=I[C];D(o.lat,o.lon,v,3.1,w,-10,E)}},n.dataset.floor=e,U.appendChild(n)});m.appendChild(U);const H=document.createElement("div");H.textContent="Direction:";H.style.marginBottom="8px";H.style.fontWeight="bold";m.appendChild(H);const V=document.createElement("div");V.style.marginBottom="15px";const ge=[{label:"N",heading:0},{label:"NE",heading:45},{label:"E",heading:90},{label:"SE",heading:135},{label:"S",heading:180},{label:"SW",heading:225},{label:"W",heading:270},{label:"NW",heading:315}];ge.forEach(e=>{const n=document.createElement("button");n.textContent=e.label,n.style.margin="2px",n.style.padding="5px 10px",n.style.backgroundColor=e.heading===w?"#4CAF50":"#555",n.style.color="white",n.style.border="none",n.style.borderRadius="3px",n.style.cursor="pointer",n.onclick=()=>{if(w=e.heading,Ce(),C!==null){const o=I[C];D(o.lat,o.lon,v,3.1,w,-10,E)}},n.dataset.heading=e.heading,V.appendChild(n)});m.appendChild(V);const q=document.createElement("div");q.style.borderTop="1px solid #555";q.style.marginTop="15px";q.style.marginBottom="15px";m.appendChild(q);const y=document.createElement("button");y.textContent="▶ More Features";y.style.width="100%";y.style.padding="8px";y.style.backgroundColor="#444";y.style.color="white";y.style.border="1px solid #555";y.style.borderRadius="3px";y.style.cursor="pointer";y.style.fontSize="12px";y.style.textAlign="left";m.appendChild(y);const L=document.createElement("div");L.textContent="Map data: Google 3D Tiles (Feb 2025)";L.style.fontSize="10px";L.style.color="#999";L.style.marginTop="10px";L.style.marginBottom="10px";L.style.textAlign="center";m.appendChild(L);const g=document.createElement("div");g.style.display="none";g.style.marginTop="12px";g.style.paddingTop="12px";g.style.borderTop="1px solid #555";let P=!1;y.onclick=()=>{P=!P,g.style.display=P?"block":"none",y.textContent=P?"▼ More Features":"▶ More Features"};const W=document.createElement("div");W.textContent="Building Types:";W.style.fontSize="12px";W.style.fontWeight="bold";W.style.marginBottom="8px";g.appendChild(W);const M=document.createElement("div");M.style.marginBottom="8px";M.style.display="flex";M.style.alignItems="center";M.style.gap="8px";const k=document.createElement("input");k.type="checkbox";k.id="condoFilter";k.checked=X;k.style.cursor="pointer";const N=document.createElement("label");N.htmlFor="condoFilter";N.textContent="Show Condos";N.style.fontSize="12px";N.style.cursor="pointer";k.onchange=()=>{X=k.checked,Z()};M.appendChild(k);M.appendChild(N);g.appendChild(M);const B=document.createElement("div");B.style.marginBottom="15px";B.style.display="flex";B.style.alignItems="center";B.style.gap="8px";const S=document.createElement("input");S.type="checkbox";S.id="apartmentFilter";S.checked=j;S.style.cursor="pointer";const z=document.createElement("label");z.htmlFor="apartmentFilter";z.textContent="Show Apartments";z.style.fontSize="12px";z.style.cursor="pointer";S.onchange=()=>{j=S.checked,Z()};B.appendChild(S);B.appendChild(z);g.appendChild(B);const F=document.createElement("div");F.textContent=`Edge offset (m): ${E}`;F.style.marginBottom="8px";F.style.fontWeight="bold";F.style.fontSize="12px";g.appendChild(F);const x=document.createElement("input");x.type="range";x.min="0";x.max="40";x.value=E.toString();x.style.width="100%";x.style.marginBottom="0";x.oninput=()=>{if(E=parseInt(x.value),F.textContent=`Edge offset (m): ${E}`,C!==null){const e=I[C];D(e.lat,e.lon,v,3.1,w,-10,E)}};g.appendChild(x);m.appendChild(g);r.appendChild(m);document.body.appendChild(r);const f=document.createElement("div");f.style.position="absolute";f.style.top="10px";f.style.right="10px";f.style.width="200px";f.style.height="40px";f.style.backgroundColor="transparent";f.style.overflow="hidden";f.style.zIndex="999";f.style.pointerEvents="none";const h=document.createElement("div");h.style.position="absolute";h.style.top="0";h.style.left="50%";h.style.height="100%";h.style.display="flex";h.style.alignItems="center";h.style.transition="transform 0.2s ease";f.appendChild(h);const _=[{deg:0,label:"N"},{deg:45,label:"NE"},{deg:90,label:"E"},{deg:135,label:"SE"},{deg:180,label:"S"},{deg:225,label:"SW"},{deg:270,label:"W"},{deg:315,label:"NW"},{deg:360,label:"N"}],Q=2;_.forEach((e,n)=>{const o=document.createElement("div");o.style.position="absolute",o.style.left=`${e.deg*Q}px`,o.style.display="flex",o.style.flexDirection="column",o.style.alignItems="center";const a=document.createElement("div");a.textContent=e.label,a.style.color="white",a.style.fontSize="11px",a.style.fontWeight="bold",a.style.fontFamily="sans-serif",a.style.textShadow="0 0 3px rgba(0,0,0,0.8)",a.style.marginBottom="2px",o.appendChild(a);const t=document.createElement("div");if(t.style.width="1px",t.style.height="12px",t.style.backgroundColor="white",t.style.boxShadow="0 0 2px rgba(0,0,0,0.8)",o.appendChild(t),n<_.length-1)for(let l=15;l<45;l+=15){const c=document.createElement("div");c.style.position="absolute",c.style.left=`${(e.deg+l)*Q}px`,c.style.width="1px",c.style.height="6px",c.style.backgroundColor="rgba(255,255,255,0.5)",c.style.marginTop="20px",h.appendChild(c)}h.appendChild(o)});document.body.appendChild(f);function ae(){const o=-((Cesium.Math.toDegrees(s.camera.heading)%360+360)%360)*Q;h.style.transform=`translateX(${o}px)`}s.scene.postRender.addEventListener(ae);ae();const b=2;function A(e){const n=s.camera.heading;let o=0,a=0;switch(e){case"forward":o=b*Math.sin(n),a=b*Math.cos(n);break;case"back":o=-b*Math.sin(n),a=-b*Math.cos(n);break;case"left":o=-b*Math.cos(n),a=b*Math.sin(n);break;case"right":o=b*Math.cos(n),a=-b*Math.sin(n);break}const t=s.camera.positionWC.clone(),l=Cesium.Transforms.eastNorthUpToFixedFrame(t),c=new Cesium.Cartesian3(o,a,0),R=Cesium.Matrix4.multiplyByPoint(l,c,new Cesium.Cartesian3);s.camera.setView({destination:R,orientation:{heading:s.camera.heading,pitch:s.camera.pitch,roll:0}}),s.scene.requestRender()}const u=document.createElement("div");u.style.position="absolute";u.style.bottom="20px";u.style.right="20px";u.style.zIndex="1000";u.style.display="grid";u.style.gridTemplateColumns="50px 50px 50px";u.style.gridTemplateRows="50px 50px";u.style.gap="4px";function $(e,n,o,a){const t=document.createElement("button");return t.textContent=e,t.style.gridColumn=o,t.style.gridRow=a,t.style.width="50px",t.style.height="50px",t.style.fontSize="20px",t.style.backgroundColor="rgba(0,0,0,0.6)",t.style.color="white",t.style.border="1px solid rgba(255,255,255,0.3)",t.style.borderRadius="6px",t.style.cursor="pointer",t.style.userSelect="none",t.style.touchAction="manipulation",t.addEventListener("pointerdown",l=>{l.preventDefault(),A(n)}),t}u.appendChild($("◀","left","1","2"));u.appendChild($("▲","forward","2","1"));u.appendChild($("▼","back","2","2"));u.appendChild($("▶","right","3","2"));document.body.appendChild(u);document.addEventListener("keydown",e=>{if(!(e.target.tagName==="INPUT"||e.target.tagName==="SELECT"||e.target.tagName==="TEXTAREA"))switch(e.key){case"w":case"W":case"ArrowUp":e.preventDefault(),A("forward");break;case"s":case"S":case"ArrowDown":e.preventDefault(),A("back");break;case"a":case"A":case"ArrowLeft":e.preventDefault(),A("left");break;case"d":case"D":case"ArrowRight":e.preventDefault(),A("right");break}});function fe(){U.querySelectorAll("button").forEach(e=>{e.style.backgroundColor=parseInt(e.dataset.floor)===v?"#4CAF50":"#555"})}function Ce(){V.querySelectorAll("button").forEach(e=>{e.style.backgroundColor=parseInt(e.dataset.heading)===w?"#4CAF50":"#555"})}const ee=setTimeout(()=>{console.log("Timeout: hiding loading overlay"),d.style.display="none"},5e3);oe.readyPromise.then(()=>{console.log("Tileset ready"),clearTimeout(ee),d.style.display="none",console.log("Loading complete, overlay hidden")}).catch(e=>{console.error("Error loading tileset:",e),clearTimeout(ee),d.textContent="Error loading 3D tiles",d.style.backgroundColor="rgba(139, 0, 0, 0.8)"});
