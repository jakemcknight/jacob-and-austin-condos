(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwZmZlYmExOS05NTFkLTQxOTgtYmViMy0yMTg0MjY0YWI3N2EiLCJpZCI6Mzg3MTMwLCJpYXQiOjE3NzAyNDg0Nzd9.IqoW2git6t3j4YITrlQTN_U95ox-h-mfrMfON2aGyLw";const ce="AIzaSyDsp4SGDDl-Gvj9wdTy-LP7c3z4Rhxv_s8";console.log("GOOGLE KEY (first 6):",ce.slice(0,6));const p=document.createElement("div");p.textContent="Loading 3D…";p.style.position="absolute";p.style.top="50%";p.style.left="50%";p.style.transform="translate(-50%, -50%)";p.style.backgroundColor="rgba(0, 0, 0, 0.8)";p.style.color="white";p.style.padding="20px 40px";p.style.borderRadius="5px";p.style.fontFamily="sans-serif";p.style.fontSize="18px";p.style.zIndex="10000";document.body.appendChild(p);const l=new Cesium.Viewer("cesiumContainer",{terrain:Cesium.Terrain.fromWorldTerrain(),animation:!1,timeline:!1,baseLayerPicker:!1,geocoder:!1,homeButton:!1,sceneModePicker:!1,navigationHelpButton:!1,requestRenderMode:!0,maximumRenderTimeChange:1/0});l.camera.setView({destination:Cesium.Cartesian3.fromDegrees(-97.7581450173393,30.263674724875994,273.7391351131449),orientation:{heading:Cesium.Math.toRadians(69.47537836441508),pitch:Cesium.Math.toRadians(-8.108186336933453),roll:0}});l.camera.frustum.fov=Cesium.Math.toRadians(110);const k=l.scene.screenSpaceCameraController;k.enableRotate=!1;k.enableTilt=!1;k.enableZoom=!1;k.enableLook=!0;k.enableTranslate=!1;k.lookEventTypes=[Cesium.CameraEventType.LEFT_DRAG];k.rotateEventTypes=[];k.tiltEventTypes=[];l.scene.preUpdate.addEventListener(()=>{Math.abs(l.camera.roll)>Cesium.Math.EPSILON6&&l.camera.setView({orientation:{heading:l.camera.heading,pitch:l.camera.pitch,roll:0}})});const pe=`https://tile.googleapis.com/v1/3dtiles/root.json?key=${ce}`;console.log("Tiles URL:",pe);const me=await Cesium.Cesium3DTileset.fromUrl(pe,{maximumScreenSpaceError:24,skipLevelOfDetail:!0,baseScreenSpaceError:1024,skipScreenSpaceErrorFactor:16,skipLevels:1,immediatelyLoadDesiredLevelOfDetail:!1,maximumMemoryUsage:512,cullWithChildrenBounds:!0});l.scene.primitives.add(me);const D=[{name:"3Waller",lat:30.2636556,lon:-97.7363348,type:"condo"},{name:"404 Rio Grande",lat:30.2687242,lon:-97.7501364,type:"condo"},{name:"Alexan Waterloo",lat:30.2710308,lon:-97.7338734,type:"apartment"},{name:"AMLI Downtown",lat:30.265293,lon:-97.746328,type:"apartment"},{name:"AMLI on 2nd",lat:30.2662019,lon:-97.7480112,type:"apartment"},{name:"Ashton Austin",lat:30.2641297,lon:-97.7453625,type:"apartment"},{name:"Camden Rainey Street",lat:30.2603388,lon:-97.738071,type:"apartment"},{name:"Capitol Quarters",lat:30.2750244,lon:-97.7466199,type:"apartment"},{name:"Elle West Ave",lat:30.268646,lon:-97.7530446,type:"apartment"},{name:"Gables Park Plaza",lat:30.2682716,lon:-97.7548273,type:"apartment"},{name:"Gables Park Tower",lat:30.2667539,lon:-97.7547424,type:"apartment"},{name:"Gables Republic Square",lat:30.2673738,lon:-97.7467997,type:"apartment"},{name:"Hanover Brazos St",lat:30.2645712,lon:-97.7424911,type:"apartment"},{name:"Hanover Republic",lat:30.267788,lon:-97.7459658,type:"apartment"},{name:"Lantana",lat:30.2823515,lon:-97.746431,type:"apartment"},{name:"Northshore",lat:30.2653566,lon:-97.7491832,type:"apartment"},{name:"Penthouse",lat:30.2817358,lon:-97.7448273,type:"condo"},{name:"Residences at 6G",lat:30.2696502,lon:-97.7466781,type:"condo"},{name:"Seven",lat:30.2705777,lon:-97.7488733,type:"apartment"},{name:"Sienna at the Thompson",lat:30.2669225,lon:-97.7416013,type:"apartment"},{name:"Skyhouse Austin",lat:30.257024,lon:-97.7390392,type:"apartment"},{name:"The Beverly at Medical Center",lat:30.2696224,lon:-97.735692,type:"apartment"},{name:"The Bowie",lat:30.2689101,lon:-97.7533905,type:"apartment"},{name:"The G",lat:30.2802583,lon:-97.7418612,type:"condo"},{name:"The Monarch by Windsor",lat:30.2690858,lon:-97.7520471,type:"apartment"},{name:"The Quincy",lat:30.2607964,lon:-97.7388694,type:"condo"},{name:"The Shoal",lat:30.2760586,lon:-97.7496873,type:"apartment"},{name:"The Waller",lat:30.2711278,lon:-97.7344463,type:"condo"},{name:"Whitley",lat:30.2650437,lon:-97.742201,type:"apartment"},{name:"Windsor on the Lake",lat:30.2559717,lon:-97.7396004,type:"apartment"},{name:"ATX Tower",lat:30.268662,lon:-97.7460608,type:"condo"},{name:"415 Colorado",lat:30.2672311,lon:-97.7442783,type:"condo"},{name:"Waterline",lat:30.2615462,lon:-97.7391219,type:"condo"},{name:"The Travis",lat:30.260094,lon:-97.7401425,type:"condo"},{name:"Paseo",lat:30.260094,lon:-97.7401425,type:"condo"},{name:"700 River",lat:30.2579816,lon:-97.7387225,type:"condo"},{name:"Austin Proper",lat:30.2662394,lon:-97.7499189,type:"condo"},{name:"Vesper",lat:30.2597364,lon:-97.7375573,type:"condo"},{name:"Plaza Lofts",lat:30.2679234,lon:-97.7464443,type:"condo"},{name:"1704 West Condos",lat:30.2815211,lon:-97.746815,type:"condo"},{name:"Four Seasons",lat:30.2619861,lon:-97.7432297,type:"condo"},{name:"The Modern",lat:30.2604192,lon:-97.7392711,type:"condo"},{name:"The Austonian",lat:30.2648019,lon:-97.7445985,type:"condo"},{name:"W Residences",lat:30.2655902,lon:-97.7465586,type:"condo"},{name:"The Linden",lat:30.2794998,lon:-97.7420515,type:"condo"},{name:"The Independent",lat:30.2677663,lon:-97.7512619,type:"condo"},{name:"70 Rainey",lat:30.2586803,lon:-97.7391402,type:"condo"},{name:"Natiivo",lat:30.2564815,lon:-97.7388538,type:"condo"},{name:"Seaholm Residences",lat:30.2671786,lon:-97.7521108,type:"condo"},{name:"44 East",lat:30.2558158,lon:-97.7390961,type:"condo"},{name:"5th & West",lat:30.2698622,lon:-97.7505104,type:"condo"},{name:"Nokonah",lat:30.2735314,lon:-97.7527068,type:"apartment"},{name:"360 Condos",lat:30.2672801,lon:-97.7497187,type:"condo"},{name:"Spring Condos",lat:30.2689443,lon:-97.7541734,type:"condo"},{name:"1306 West",lat:30.2779487,lon:-97.7481718,type:"condo"},{name:"Westgate Tower",lat:30.2741074,lon:-97.7428798,type:"condo"},{name:"904 West Condos",lat:30.2736945,lon:-97.7497312,type:"condo"},{name:"The Shore",lat:30.2593466,lon:-97.7393206,type:"condo"},{name:"Five Fifty 05",lat:30.265231,lon:-97.7381056,type:"condo"},{name:"Penthouse Condos",lat:30.275913,lon:-97.7441529,type:"condo"},{name:"Austin City Lofts",lat:30.2697168,lon:-97.7516014,type:"condo"},{name:"Brown Building",lat:30.2700066,lon:-97.7438733,type:"condo"},{name:"Cambridge Tower",lat:30.2807704,lon:-97.7403971,type:"condo"},{name:"Celias Court",lat:30.2731851,lon:-97.7473822,type:"condo"},{name:"Milago",lat:30.2569365,lon:-97.7397606,type:"condo"},{name:"Sabine on 5th",lat:30.2654934,lon:-97.7361143,type:"condo"},{name:"Brazos Place",lat:30.2698301,lon:-97.7408344,type:"condo"},{name:"Terrace on Shoal Creek",lat:30.2756567,lon:-97.7503839,type:"apartment"},{name:"Towers of Town Lake",lat:30.2550288,lon:-97.7379358,type:"condo"},{name:"Greenwood Tower",lat:30.2805409,lon:-97.7411384,type:"condo"}],ie=40;function Z(e){return e===null?ie:D[e].floors||ie}let y=null,d=10,L=0,S=15,ee=!0,te=!1;const N=new Map;async function q(e,o,n,a=3.1,t,s=-10,r=15){const M=`${e},${o}`;if(!N.has(M)){const we=Cesium.Cartographic.fromDegrees(o,e),[ve]=await Cesium.sampleTerrainMostDetailed(l.terrainProvider,[we]);N.set(M,ve.height)}const ue=N.get(M)+n*a,he=Cesium.Cartesian3.fromDegrees(o,e,ue),se=Cesium.Math.toRadians(t),ge=r*Math.sin(se),fe=r*Math.cos(se),Ce=0,xe=Cesium.Transforms.eastNorthUpToFixedFrame(he),be=new Cesium.Cartesian3(ge,fe,Ce),Ee=Cesium.Matrix4.multiplyByPoint(xe,be,new Cesium.Cartesian3);l.camera.setView({destination:Ee,orientation:{heading:Cesium.Math.toRadians(t),pitch:Cesium.Math.toRadians(s),roll:0}}),l.camera.frustum.fov=Cesium.Math.toRadians(100),l.scene.requestRender()}function ne(e){if(y===null)return;const o=3.1,n=D[y],a=`${n.lat},${n.lon}`;if(!N.has(a)){q(n.lat,n.lon,e,o,L,-10,S);return}const s=N.get(a)+e*o,r=Cesium.Cartographic.fromCartesian(l.camera.positionWC),M=Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,s);l.camera.setView({destination:M,orientation:{heading:l.camera.heading,pitch:l.camera.pitch,roll:0}}),l.scene.requestRender()}const c=document.createElement("div");c.style.position="absolute";c.style.top="10px";c.style.left="10px";c.style.backgroundColor="rgba(0, 0, 0, 0.7)";c.style.color="white";c.style.padding="15px";c.style.borderRadius="5px";c.style.fontFamily="sans-serif";c.style.fontSize="14px";c.style.zIndex="1000";const i=document.createElement("button");i.textContent="◀";i.style.position="absolute";i.style.top="5px";i.style.right="5px";i.style.width="25px";i.style.height="25px";i.style.padding="0";i.style.backgroundColor="#555";i.style.color="white";i.style.border="1px solid #666";i.style.borderRadius="3px";i.style.cursor="pointer";i.style.fontSize="12px";i.title="Collapse panel";c.appendChild(i);const u=document.createElement("div");let K=!1;i.onclick=()=>{K=!K,K?(u.style.display="none",c.style.padding="5px",c.style.width="35px",i.textContent="▶",i.title="Expand panel"):(u.style.display="block",c.style.padding="15px",c.style.width="auto",i.textContent="◀",i.title="Collapse panel")};const Y=document.createElement("div");Y.textContent="Building:";Y.style.marginBottom="8px";Y.style.fontWeight="bold";u.appendChild(Y);const m=document.createElement("select");m.style.width="100%";m.style.padding="5px";m.style.marginBottom="15px";m.style.backgroundColor="#333";m.style.color="white";m.style.border="1px solid #555";m.style.borderRadius="3px";m.style.fontSize="14px";function oe(){m.innerHTML="";const e=document.createElement("option");e.value="",e.textContent="Select a building",e.disabled=!0,e.selected=y===null,m.appendChild(e),D.map((n,a)=>({building:n,index:a})).filter(({building:n})=>n.type==="condo"&&ee||n.type==="apartment"&&te).sort((n,a)=>n.building.name.localeCompare(a.building.name)).forEach(({building:n,index:a})=>{const t=document.createElement("option");t.value=a,t.textContent=n.name,y===a&&(t.selected=!0),m.appendChild(t)})}m.onchange=()=>{if(m.value==="")return;y=parseInt(m.value),le();const e=D[y];q(e.lat,e.lon,d,3.1,L,-10,S)};oe();u.appendChild(m);const O=document.createElement("div");O.style.marginBottom="8px";O.style.fontWeight="bold";O.textContent="Floor: ";const G=document.createElement("span");G.textContent=d;G.style.color="#4CAF50";O.appendChild(G);u.appendChild(O);const ae=document.createElement("div");ae.style.marginBottom="15px";const B=document.createElement("div");B.style.display="flex";B.style.alignItems="center";B.style.gap="6px";const x=document.createElement("button");x.textContent="-";x.style.width="30px";x.style.height="30px";x.style.backgroundColor="#555";x.style.color="white";x.style.border="none";x.style.borderRadius="3px";x.style.cursor="pointer";x.style.fontSize="16px";x.onclick=()=>{d>1&&(d--,le(),ne(d))};const f=document.createElement("input");f.type="range";f.min="1";f.max=Z(y).toString();f.value=d.toString();f.step="1";f.style.flex="1";f.style.accentColor="#4CAF50";f.oninput=()=>{d=parseInt(f.value),G.textContent=d,ne(d)};const b=document.createElement("button");b.textContent="+";b.style.width="30px";b.style.height="30px";b.style.backgroundColor="#555";b.style.color="white";b.style.border="none";b.style.borderRadius="3px";b.style.cursor="pointer";b.style.fontSize="16px";b.onclick=()=>{d<Z(y)&&(d++,le(),ne(d))};B.appendChild(x);B.appendChild(f);B.appendChild(b);ae.appendChild(B);u.appendChild(ae);const J=document.createElement("div");J.textContent="Direction:";J.style.marginBottom="8px";J.style.fontWeight="bold";u.appendChild(J);const X=document.createElement("div");X.style.marginBottom="15px";const Te=[{label:"N",heading:0},{label:"NE",heading:45},{label:"E",heading:90},{label:"SE",heading:135},{label:"S",heading:180},{label:"SW",heading:225},{label:"W",heading:270},{label:"NW",heading:315}];Te.forEach(e=>{const o=document.createElement("button");o.textContent=e.label,o.style.margin="2px",o.style.padding="5px 10px",o.style.backgroundColor=e.heading===L?"#4CAF50":"#555",o.style.color="white",o.style.border="none",o.style.borderRadius="3px",o.style.cursor="pointer",o.onclick=()=>{if(L=e.heading,Se(),y!==null){const n=D[y];q(n.lat,n.lon,d,3.1,L,-10,S)}},o.dataset.heading=e.heading,X.appendChild(o)});u.appendChild(X);const _=document.createElement("div");_.style.borderTop="1px solid #555";_.style.marginTop="15px";_.style.marginBottom="15px";u.appendChild(_);const h=document.createElement("button");h.textContent="▶ More Features";h.style.width="100%";h.style.padding="8px";h.style.backgroundColor="#444";h.style.color="white";h.style.border="1px solid #555";h.style.borderRadius="3px";h.style.cursor="pointer";h.style.fontSize="12px";h.style.textAlign="left";u.appendChild(h);const A=document.createElement("div");A.textContent="Map data: Google 3D Tiles (Feb 2025)";A.style.fontSize="10px";A.style.color="#999";A.style.marginTop="10px";A.style.marginBottom="10px";A.style.textAlign="center";u.appendChild(A);const E=document.createElement("div");E.style.display="none";E.style.marginTop="12px";E.style.paddingTop="12px";E.style.borderTop="1px solid #555";let $=!1;h.onclick=()=>{$=!$,E.style.display=$?"block":"none",h.textContent=$?"▼ More Features":"▶ More Features"};const U=document.createElement("div");U.textContent="Building Types:";U.style.fontSize="12px";U.style.fontWeight="bold";U.style.marginBottom="8px";E.appendChild(U);const I=document.createElement("div");I.style.marginBottom="8px";I.style.display="flex";I.style.alignItems="center";I.style.gap="8px";const R=document.createElement("input");R.type="checkbox";R.id="condoFilter";R.checked=ee;R.style.cursor="pointer";const H=document.createElement("label");H.htmlFor="condoFilter";H.textContent="Show Condos";H.style.fontSize="12px";H.style.cursor="pointer";R.onchange=()=>{ee=R.checked,oe()};I.appendChild(R);I.appendChild(H);E.appendChild(I);const W=document.createElement("div");W.style.marginBottom="15px";W.style.display="flex";W.style.alignItems="center";W.style.gap="8px";const F=document.createElement("input");F.type="checkbox";F.id="apartmentFilter";F.checked=te;F.style.cursor="pointer";const V=document.createElement("label");V.htmlFor="apartmentFilter";V.textContent="Show Apartments";V.style.fontSize="12px";V.style.cursor="pointer";F.onchange=()=>{te=F.checked,oe()};W.appendChild(F);W.appendChild(V);E.appendChild(W);const z=document.createElement("div");z.textContent=`Edge offset (m): ${S}`;z.style.marginBottom="8px";z.style.fontWeight="bold";z.style.fontSize="12px";E.appendChild(z);const v=document.createElement("input");v.type="range";v.min="0";v.max="40";v.value=S.toString();v.style.width="100%";v.style.marginBottom="0";v.oninput=()=>{if(S=parseInt(v.value),z.textContent=`Edge offset (m): ${S}`,y!==null){const e=D[y];q(e.lat,e.lon,d,3.1,L,-10,S)}};E.appendChild(v);u.appendChild(E);c.appendChild(u);document.body.appendChild(c);const w=document.createElement("div");w.style.position="absolute";w.style.top="10px";w.style.right="10px";w.style.width="200px";w.style.height="40px";w.style.backgroundColor="transparent";w.style.overflow="hidden";w.style.zIndex="999";w.style.pointerEvents="none";const C=document.createElement("div");C.style.position="absolute";C.style.top="0";C.style.left="50%";C.style.height="100%";C.style.display="flex";C.style.alignItems="center";C.style.transition="transform 0.2s ease";w.appendChild(C);const re=[{deg:0,label:"N"},{deg:45,label:"NE"},{deg:90,label:"E"},{deg:135,label:"SE"},{deg:180,label:"S"},{deg:225,label:"SW"},{deg:270,label:"W"},{deg:315,label:"NW"},{deg:360,label:"N"}],Q=2;re.forEach((e,o)=>{const n=document.createElement("div");n.style.position="absolute",n.style.left=`${e.deg*Q}px`,n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="center";const a=document.createElement("div");a.textContent=e.label,a.style.color="white",a.style.fontSize="11px",a.style.fontWeight="bold",a.style.fontFamily="sans-serif",a.style.textShadow="0 0 3px rgba(0,0,0,0.8)",a.style.marginBottom="2px",n.appendChild(a);const t=document.createElement("div");if(t.style.width="1px",t.style.height="12px",t.style.backgroundColor="white",t.style.boxShadow="0 0 2px rgba(0,0,0,0.8)",n.appendChild(t),o<re.length-1)for(let s=15;s<45;s+=15){const r=document.createElement("div");r.style.position="absolute",r.style.left=`${(e.deg+s)*Q}px`,r.style.width="1px",r.style.height="6px",r.style.backgroundColor="rgba(255,255,255,0.5)",r.style.marginTop="20px",C.appendChild(r)}C.appendChild(n)});document.body.appendChild(w);function ye(){const n=-((Cesium.Math.toDegrees(l.camera.heading)%360+360)%360)*Q;C.style.transform=`translateX(${n}px)`}l.scene.postRender.addEventListener(ye);ye();const T=2;function P(e){const o=l.camera.heading;let n=0,a=0;switch(e){case"forward":n=T*Math.sin(o),a=T*Math.cos(o);break;case"back":n=-T*Math.sin(o),a=-T*Math.cos(o);break;case"left":n=-T*Math.cos(o),a=T*Math.sin(o);break;case"right":n=T*Math.cos(o),a=-T*Math.sin(o);break}const t=l.camera.positionWC.clone(),s=Cesium.Transforms.eastNorthUpToFixedFrame(t),r=new Cesium.Cartesian3(n,a,0),M=Cesium.Matrix4.multiplyByPoint(s,r,new Cesium.Cartesian3);l.camera.setView({destination:M,orientation:{heading:l.camera.heading,pitch:l.camera.pitch,roll:0}}),l.scene.requestRender()}const g=document.createElement("div");g.style.position="absolute";g.style.bottom="20px";g.style.right="20px";g.style.zIndex="1000";g.style.display="grid";g.style.gridTemplateColumns="50px 50px 50px";g.style.gridTemplateRows="50px 50px";g.style.gap="4px";function j(e,o,n,a){const t=document.createElement("button");return t.textContent=e,t.style.gridColumn=n,t.style.gridRow=a,t.style.width="50px",t.style.height="50px",t.style.fontSize="20px",t.style.backgroundColor="rgba(0,0,0,0.6)",t.style.color="white",t.style.border="1px solid rgba(255,255,255,0.3)",t.style.borderRadius="6px",t.style.cursor="pointer",t.style.userSelect="none",t.style.touchAction="manipulation",t.addEventListener("pointerdown",s=>{s.preventDefault(),P(o)}),t}g.appendChild(j("◀","left","1","2"));g.appendChild(j("▲","forward","2","1"));g.appendChild(j("▼","back","2","2"));g.appendChild(j("▶","right","3","2"));document.body.appendChild(g);document.addEventListener("keydown",e=>{if(!(e.target.tagName==="INPUT"||e.target.tagName==="SELECT"||e.target.tagName==="TEXTAREA"))switch(e.key){case"w":case"W":case"ArrowUp":e.preventDefault(),P("forward");break;case"s":case"S":case"ArrowDown":e.preventDefault(),P("back");break;case"a":case"A":case"ArrowLeft":e.preventDefault(),P("left");break;case"d":case"D":case"ArrowRight":e.preventDefault(),P("right");break}});function le(){const e=Z(y);f.max=e.toString(),d>e&&(d=e),f.value=d.toString(),G.textContent=d}function Se(){X.querySelectorAll("button").forEach(e=>{e.style.backgroundColor=parseInt(e.dataset.heading)===L?"#4CAF50":"#555"})}const de=setTimeout(()=>{console.log("Timeout: hiding loading overlay"),p.style.display="none"},5e3);me.readyPromise.then(()=>{console.log("Tileset ready"),clearTimeout(de),p.style.display="none",console.log("Loading complete, overlay hidden")}).catch(e=>{console.error("Error loading tileset:",e),clearTimeout(de),p.textContent="Error loading 3D tiles",p.style.backgroundColor="rgba(139, 0, 0, 0.8)"});
